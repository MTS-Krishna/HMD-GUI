from oletools.olevba import VBA_Parser

def extract_office_features(file_path):
    try:
        vba_parser = VBA_Parser(file_path)
        features = {
            "has_macros": vba_parser.detect_vba_macros(),
            "macro_code": vba_parser.extract_macros() if vba_parser.detect_vba_macros() else None
        }
        return features
    except Exception as e:
        print(f"Office Parsing Error: {e}")
        return {}
