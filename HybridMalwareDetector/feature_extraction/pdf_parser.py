import subprocess
import json

def parse_pdfid_output(file_path):
    """
    Extract features from a PDF file using pdfid.py.
    Returns a dictionary of extracted features.
    """
    try:
        # Run pdfid.py and capture output
        result = subprocess.run(["python", "pdfid.py", file_path], capture_output=True, text=True)

        # If there's an error in execution
        if result.returncode != 0:
            return {}

        output = result.stdout.strip()

        # Ensure output is parsed into a dictionary
        feature_dict = {}
        for line in output.split("\n"):
            if line.startswith("/"):
                parts = line.split()
                if len(parts) == 2:
                    feature_name, count = parts
                    feature_dict[feature_name] = int(count)

        return feature_dict

    except Exception as e:
        print(f"Error parsing PDF: {e}")
        return {}
