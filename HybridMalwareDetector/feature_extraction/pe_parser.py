import lief

def extract_pe_features(file_path):
    try:
        pe = lief.parse(file_path)
        features = {
            "imports": len(pe.imports),
            "sections": len(pe.sections),
            "entry_point": pe.optional_header.addressof_entrypoint,
            "size_of_code": pe.optional_header.sizeof_code,
            "size_of_image": pe.optional_header.sizeof_image,
        }
        return features
    except Exception as e:
        print(f"PE Parsing Error: {e}")
        return {}
